(()=>{"use strict";var t={8294:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e,n,i){this.fnc=t,this.key=e,this.once=n,this.context=i,this.calls=0}return t.prototype.call=function(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return!(this.once&&this.calls>0||((t=this.fnc).apply.apply(t,[this.context].concat(e)),this.calls+=1,0))},t}();e.EventCallback=n;var i=function(){function t(){this._lastKey=0,this._listeners={}}return t.prototype.bind=function(t,e,i,r){return r=r||!1,this._lastKey++,this._listeners[t]=this._listeners[t]||[],this._listeners[t].push(new n(e,this._lastKey,r,i)),this._lastKey},t.prototype.once=function(t,e,n){return this.bind(t,e,n,!0)},t.prototype.unbind=function(t,e){if(t in this._listeners==0)return!1;if(!e)return this._listeners[t]=[],!0;for(var n=0,i=this._listeners[t];n<i.length;n++){var r=i[n];if(e==r.key)return this._listeners[t].splice(this._listeners[t].indexOf(r),1),!0}return!1},t.prototype.unbindWithContext=function(t,e){if(t in this._listeners==0)return 0;for(var n=[],i=0,r=0,s=this._listeners[t];r<s.length;r++)e==(c=s[r]).context&&n.push(c);for(var o=0,a=n;o<a.length;o++){var c=a[o];this._listeners[t].splice(this._listeners[t].indexOf(c),1),i++}return i},t.prototype.getListener=function(t,e){for(var n=0,i=this._listeners[t];n<i.length;n++){var r=i[n];if(e==r.key)return r}},t.prototype.trigger=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(t in this._listeners!=0)for(var i=0;i<this._listeners[t].length;i++){var r=this._listeners[t][i];r.once&&(this.unbind(t,r.key),i--),r.call(e)}},t}();e.EventDispatcher=i},9959:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t){this.reset(),t&&this.merge(t)}return t.prototype.reset=function(){var t=this.keys;if(this._cachedList=void 0,t.length>0)for(var e=0,n=t;e<n.length;e++)delete this[n[e]]},t.prototype.add=function(t,e,n){var i;void 0===n&&(n=!1),this.merge(((i={})[t]="string"==typeof e?[e]:e,i),n)},t.prototype.merge=function(t,e){var n=this;if(void 0===e&&(e=!1),t){this._cachedList=void 0;var i=this.keys,r=function(r){if(!t.hasOwnProperty(r))return"continue";var o=t[r];o instanceof Array&&(!e&&i.indexOf(r)>-1?o.map((function(t){n[r].push(t)})):o.length>0&&(s[r]=o))},s=this;for(var o in t)r(o)}},Object.defineProperty(t.prototype,"list",{get:function(){if(this._cachedList)return this._cachedList;for(var t={},e=0,n=this.keys;e<n.length;e++){var i=n[e];t[i]=this[i]}return this._cachedList=t,t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"keys",{get:function(){var t=Object.keys(this);return t.splice(t.indexOf("_cachedList"),1),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function(){return this.keys.length},enumerable:!1,configurable:!0}),t}();e.default=n},9072:function(t,e){var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.Collection=void 0;var r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.getData=function(){for(var t=[],n=0,i=e;n<i.length;n++){var r=i[n];t.push(r.getData())}return t},e}return i(e,t),e}(Array);e.Collection=r},6297:function(t,e,n){var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.DataModel=void 0;var s=function(t){function e(e){var n=t.call(this)||this;if(e instanceof Array){n.__fields__=e;for(var i=0,r=e;i<r.length;i++){var s=r[i];n.createField(s)}}else n.setData(e);return n}return r(e,t),e.prototype.setData=function(e){for(var n=0,i=Object.keys(e);n<i.length;n++){var r=i[n];-1==this.__fields__.indexOf(r)&&(this.__fields__.push(r),this.createField(r))}t.prototype.setData.call(this,e)},e.prototype.bind=function(e,n,i,r){return 0==e.indexOf("change:")&&this.createField(e.substr(7)),t.prototype.bind.call(this,e,n,i,r)},e}(n(6412).ModelAbstract);e.DataModel=s},9143:function(t,e,n){var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.Model=void 0;var s=n(9959),o=function(t){function e(e){void 0===e&&(e=null);for(var n=t.call(this)||this,i=0,r=n.__fields__.splice(0,n.__fields__.length);i<r.length;i++)!function(t,e){if(t["__"+e+"__"]){t.__fields__.push(e);var n=t["__"+e+"__"],i=n[0],r=n[1]||{};t.createField(e,i,r)}}(n,r[i]);return n._hasErrors=!1,e&&n.setData(e),n._lastData=n.getData(),n._constructor(),n}return r(e,t),e.prototype._constructor=function(){},e.prototype.validate=function(){this._hasErrors=!1,this._errors=new s.default;for(var t=0,e=this.getFields();t<e.length;t++){var n=e[t],i=this["__"+n].validate();i.length>0&&(this._errors.add(n,i,!0),this._hasErrors=!0)}return this._errors},e.prototype.hasErrors=function(){return this.validate(),this._hasErrors},Object.defineProperty(e.prototype,"errors",{get:function(){return this._errors},enumerable:!1,configurable:!0}),e}(n(6412).ModelAbstract);e.Model=o},6412:function(t,e,n){var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=this&&this.__spreadArray||function(t,e){for(var n=0,i=e.length,r=t.length;n<i;n++,r++)t[r]=e[n];return t};Object.defineProperty(e,"__esModule",{value:!0}),e.ModelAbstract=void 0;var o=n(8294),a=n(8420),c=function(t){function e(){var e=t.call(this)||this;return e.__fields__||(e.__fields__=[]),e}return r(e,t),e.prototype.createField=function(t,e,n){var i=this;void 0===e&&(e=a.Field);var r=new e(this,(n=n||{}).default,n),o=Object.getOwnPropertyDescriptor(this,t);this["__"+t]=r;var c=o?o.get:function(){return r.value},u=o?o.set:function(t){r.value=t};return delete this[t],Object.defineProperty(this,t,{get:c,set:u,enumerable:!0,configurable:!0}),r.bind("change",(function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];i.trigger.apply(i,s(["change",t],e)),i.trigger.apply(i,s(["change:"+t],e))})),r},e.prototype.setData=function(t){var e=this.getFields();for(var n in t)e.indexOf(n)>-1&&(this[n]=t[n])},e.prototype.getData=function(){for(var t={},e=0,n=this.getFields();e<n.length;e++){var i=n[e],r=this["__"+i];null!=this[i]&&r&&(t[i]=r.getData())}return t},e.prototype.getFields=function(){return this.__fields__},e.prototype.getField=function(t){return this["__"+t]},e.prototype.bindToFields=function(t,e,n){for(var i=0,r=e;i<r.length;i++){var s=this["__"+r[i]];s&&s.bind(t,n)}},e.prototype.setLastData=function(){this._lastData=this.getData()},e.prototype.revert=function(){this.setData(this._lastData)},e.prototype.isModified=function(){for(var t=this._lastData,e=this.getData(),n=0,i=this.getFields();n<i.length;n++){var r=i[n];if(e[r]!=t[r])return!0}return!1},e}(o.EventDispatcher);e.ModelAbstract=c},1624:function(t,e,n){var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.BooleanField=void 0;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(t){var e=this.value;this._value=!!t,this.trigger("change",{oldValue:e,value:t})},enumerable:!1,configurable:!0}),e}(n(8420).Field);e.BooleanField=s},8014:function(t,e,n){var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.EmailField=void 0;var s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._emailRegex=/^(([^<>()\[\]\.,;:\s@\"]+(\.[^<>()\[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i,e}return r(e,t),e.prototype.validate=function(){return t.prototype.validate.call(this),null==this._value||this._emailRegex.test(this._value)||this._errors.push("Please enter a valid email address"),this._errors},e}(n(8420).Field);e.EmailField=s},8420:function(t,e,n){var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.Field=e.field=void 0;var s=n(8294);e.field=function(t,e){return void 0===t&&(t=o),void 0===e&&(e={}),function(n,i){null==n.__fields__&&(n.__fields__=[]),-1==n.__fields__.indexOf(i)&&n.__fields__.push(i),Object.defineProperty(n,"__"+i+"__",{get:function(){return[t,e]},set:function(t){},enumerable:!1,configurable:!0})}};var o=function(t){function e(e,n,i){var r=t.call(this)||this;return r.model=e,r.config=i,r.value=n,r._errors=[],r}return r(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(t){var e=this._value;this._value=t,this.trigger("change",{oldValue:e,value:t})},enumerable:!1,configurable:!0}),e.prototype.getData=function(){return this.value},e.prototype.validate=function(){return this._errors=[],1==this.config.required&&null==this._value&&this._errors.push("This field is required."),this._errors},e}(s.EventDispatcher);e.Field=o},2030:function(t,e,n){var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.FloatField=void 0;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(t){var e=this.value;"string"==typeof t&&(t=parseFloat(t)),"number"==typeof t&&this.config.toFixed&&(t=parseFloat(t.toFixed(this.config.toFixed))),this._value=t,this.trigger("change",{oldValue:e,value:t})},enumerable:!1,configurable:!0}),e}(n(8420).Field);e.FloatField=s},3985:function(t,e,n){var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.PositiveIntegerField=void 0;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(t){var e=this.value;null!=t?("string"==typeof t&&(t=parseInt(t)),t<=0&&(t=0),this._value=t,this.trigger("change",{oldValue:e,value:t})):this._value=null},enumerable:!1,configurable:!0}),e}(n(8420).Field);e.PositiveIntegerField=s},2956:function(t,e,n){var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.StringField=void 0;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(t){var e=this.value;this._value=""+t,this.trigger("change",{oldValue:e,value:t})},enumerable:!1,configurable:!0}),e}(n(8420).Field);e.StringField=s},6586:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.fields=e.field=e.Collection=e.Model=e.DataModel=void 0;var i=n(8420);Object.defineProperty(e,"field",{enumerable:!0,get:function(){return i.field}});var r=n(1624),s=n(8014),o=n(2030),a=n(3985),c=n(2956),u=n(6297);Object.defineProperty(e,"DataModel",{enumerable:!0,get:function(){return u.DataModel}});var l=n(9143);Object.defineProperty(e,"Model",{enumerable:!0,get:function(){return l.Model}});var h=n(9072);Object.defineProperty(e,"Collection",{enumerable:!0,get:function(){return h.Collection}});var p={Field:i.Field,BooleanField:r.BooleanField,EmailField:s.EmailField,FloatField:o.FloatField,PositiveIntegerField:a.PositiveIntegerField,StringField:c.StringField};e.fields=p},8513:function(t,e,n){var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.Promise=e.noop=e.EPromiseStates=void 0;var s,o=n(8294);!function(t){t[t.PENDING=0]="PENDING",t[t.FULFILLED=1]="FULFILLED",t[t.REJECTED=2]="REJECTED"}(s=e.EPromiseStates||(e.EPromiseStates={})),e.noop=function(t){return t};var a=function(t){function e(e){var n=t.call(this)||this;n._result=null,n._state=s.PENDING,n.promiseClass=Object.getPrototypeOf(n).constructor;try{e(n._resolve.bind(n),n._reject.bind(n))}catch(t){n._reject(t)}return n}return r(e,t),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"result",{get:function(){return this._result},enumerable:!1,configurable:!0}),e.defer=function(){var t=new e((function(t,e){}));return{promise:t,resolve:t._resolve.bind(t),reject:t._reject.bind(t)}},e.resolve=function(t){return new e((function(n){t instanceof e?t.then((function(t){n(t)})):n(t)}))},e.reject=function(t){return new e((function(e,n){n(t)}))},e.all=function(t){for(var n=e.defer(),i=!0,r=0,o=t;r<o.length;r++){var a=o[r];if(a.state==s.PENDING)i=!1,a.once("fulfilled",(function(i){e.poolResults(t,n)})),a.once("rejected",(function(t){n.reject(t)}));else if(a.state==s.REJECTED){n.reject(a.result),i=!1;break}}return i&&e.poolResults(t,n),n.promise},e.poolResults=function(t,e){for(var n=!0,i=[],r=0,o=t;r<o.length;r++){var a=o[r];if(a.state===s.REJECTED){e.reject(a.result);break}a.state===s.PENDING&&(n=!1),i.push(a.result)}n&&e.resolve(i)},e.race=function(t){for(var n=e.defer(),i=0,r=t;i<r.length;i++){var s=r[i];s.once("fulfilled",(function(t){n.resolve(t)})),s.once("rejected",(function(t){n.reject(t)}))}return n.promise},e.prototype.then=function(t,e){var n=this;return new this.promiseClass((function(i,r){n.state===s.FULFILLED?t&&i(t(n.result)):n.state===s.REJECTED?e&&r(e(n.result)):(n.once("fulfilled",(function(e){t&&i(t(e))})),n.once("rejected",(function(t){e&&r(e(t))})))}))},e.prototype.catch=function(t){return this.then(void 0,t)},e.prototype.finally=function(t){return this.then((function(e){return t(e)}),(function(e){return t(e)}))},e.prototype._resolve=function(t){this.state===s.PENDING&&(this._state=s.FULFILLED,this._result=t,this.trigger("fulfilled",t))},e.prototype._reject=function(t){this.state===s.PENDING&&(this._state=s.REJECTED,this._result=t,this.trigger("rejected",t))},e}(o.EventDispatcher);e.Promise=a},7754:function(t,e,n){var i=this&&this.__decorate||function(t,e,n,i){var r,s=arguments.length,o=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,n,o):r(e,n))||o);return s>3&&o&&Object.defineProperty(e,n,o),o},r=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.Tree=e.AttributableNodes=e.BlockNode=e.Node=e.TokenType=e.BlockType=void 0;const s=n(4843),o=n(712),a=n(44);var c,u;!function(t){t[t.BRACE=0]="BRACE",t[t.BRACKET=1]="BRACKET",t[t.PAREN=2]="PAREN",t[t.STATEMENT=3]="STATEMENT"}(c=e.BlockType||(e.BlockType={})),function(t){t[t.WHITESPACE=0]="WHITESPACE",t[t.TYPE_INT=1]="TYPE_INT",t[t.TYPE_UINT=2]="TYPE_UINT",t[t.TYPE_FLOAT=3]="TYPE_FLOAT",t[t.TYPE_STRING=4]="TYPE_STRING",t[t.RETURN=5]="RETURN",t[t.OF=6]="OF",t[t.IN=7]="IN",t[t.FOR=8]="FOR",t[t.IF=9]="IF",t[t.ELSE_IF=10]="ELSE_IF",t[t.ELSE=11]="ELSE",t[t.NAME=12]="NAME",t[t.L_BRACE=13]="L_BRACE",t[t.R_BRACE=14]="R_BRACE",t[t.L_BRACKET=15]="L_BRACKET",t[t.R_BRACKET=16]="R_BRACKET",t[t.L_PAREN=17]="L_PAREN",t[t.R_PAREN=18]="R_PAREN",t[t.PERIOD=19]="PERIOD",t[t.COMMA=20]="COMMA",t[t.COLON=21]="COLON",t[t.SEMI_COLON=22]="SEMI_COLON",t[t.STRING_LITERAL=23]="STRING_LITERAL",t[t.NUMBER_LITERAL=24]="NUMBER_LITERAL",t[t.BOOLEAN_LITERAL=25]="BOOLEAN_LITERAL",t[t.NULL_LITERAL=26]="NULL_LITERAL",t[t.STRICT_EQUALS=27]="STRICT_EQUALS",t[t.STRICT_NOT_EQUALS=28]="STRICT_NOT_EQUALS",t[t.EQUALS=29]="EQUALS",t[t.NOT_EQUALS=30]="NOT_EQUALS",t[t.GREATER_THAN_EQUAL=31]="GREATER_THAN_EQUAL",t[t.LESS_THAN_EQUAL=32]="LESS_THAN_EQUAL",t[t.GREATER_THAN=33]="GREATER_THAN",t[t.LESS_THAN=34]="LESS_THAN",t[t.ASSIGN=35]="ASSIGN",t[t.AND=36]="AND",t[t.OR=37]="OR",t[t.ADD=38]="ADD",t[t.SUBTRACT=39]="SUBTRACT",t[t.MULTIPLY=40]="MULTIPLY",t[t.DIVIDE=41]="DIVIDE",t[t.ADD_ASSIGN=42]="ADD_ASSIGN",t[t.SUBTRACT_ASSIGN=43]="SUBTRACT_ASSIGN",t[t.MULTIPLY_ASSIGN=44]="MULTIPLY_ASSIGN",t[t.DIVIDE_ASSIGN=45]="DIVIDE_ASSIGN",t[t.EXCLAMATION_POINT=46]="EXCLAMATION_POINT",t[t.ELEMENT_REFERENCE=47]="ELEMENT_REFERENCE",t[t.ELEMENT_ATTRIBUTE=48]="ELEMENT_ATTRIBUTE",t[t.ELEMENT_QUERY=49]="ELEMENT_QUERY"}(u=e.TokenType||(e.TokenType={}));const l=[{type:u.WHITESPACE,pattern:/^[\s\n\r]+/},{type:u.TYPE_INT,pattern:/^int+/},{type:u.TYPE_UINT,pattern:/^uint+/},{type:u.TYPE_FLOAT,pattern:/^float+/},{type:u.TYPE_STRING,pattern:/^string+/},{type:u.BOOLEAN_LITERAL,pattern:/^(true|false)/},{type:u.NULL_LITERAL,pattern:/^null/},{type:u.RETURN,pattern:/^return\s/},{type:u.OF,pattern:/^of\s/},{type:u.FOR,pattern:/^for\s/},{type:u.IF,pattern:/^if\s/},{type:u.ELSE_IF,pattern:/^else if\s/},{type:u.ELSE,pattern:/^else\s/},{type:u.ELEMENT_ATTRIBUTE,pattern:/^\.@[_a-zA-Z0-9]*/},{type:u.ELEMENT_REFERENCE,pattern:/^#[-_a-zA-Z0-9]*/},{type:u.ELEMENT_QUERY,pattern:/^\?([#.\[\],=\-_a-zA-Z0-9*\s]*[\]_a-zA-Z0-9*])/},{type:u.NAME,pattern:/^[$_a-zA-Z][_a-zA-Z0-9]*/},{type:u.NUMBER_LITERAL,pattern:/^-?\d+(?:\.\d+)?(?:e[+\-]?\d+)?/i},{type:u.L_BRACE,pattern:/^{/},{type:u.R_BRACE,pattern:/^}/},{type:u.L_BRACKET,pattern:/^\[/},{type:u.R_BRACKET,pattern:/^]/},{type:u.L_PAREN,pattern:/^\(/},{type:u.R_PAREN,pattern:/^\)/},{type:u.PERIOD,pattern:/^\./},{type:u.COMMA,pattern:/^,/},{type:u.EQUALS,pattern:/^==/},{type:u.NOT_EQUALS,pattern:/^!=/},{type:u.GREATER_THAN,pattern:/^>/},{type:u.LESS_THAN,pattern:/^</},{type:u.GREATER_THAN_EQUAL,pattern:/^>=/},{type:u.LESS_THAN_EQUAL,pattern:/^<=/},{type:u.COLON,pattern:/^:/},{type:u.SEMI_COLON,pattern:/^;/},{type:u.STRING_LITERAL,pattern:/^"([^"]*)"/},{type:u.STRING_LITERAL,pattern:/^'([^']*)'/},{type:u.AND,pattern:/^&&/},{type:u.OR,pattern:/^\|\|/},{type:u.ADD_ASSIGN,pattern:/^\+=/},{type:u.SUBTRACT_ASSIGN,pattern:/^-=/},{type:u.MULTIPLY_ASSIGN,pattern:/^\*=/},{type:u.DIVIDE_ASSIGN,pattern:/^\/=/},{type:u.ADD,pattern:/^\+/},{type:u.SUBTRACT,pattern:/^-/},{type:u.MULTIPLY,pattern:/^\*/},{type:u.DIVIDE,pattern:/^\//},{type:u.ASSIGN,pattern:/^=/},{type:u.EXCLAMATION_POINT,pattern:/^!/}];class h{constructor(){this.requiresPrep=!1,this.nodeCache={}}isPreparationRequired(){if(this.requiresPrep)return!0;if(void 0!==this._isPreparationRequired)return this._isPreparationRequired;for(const t of this.getChildNodes())if(t.isPreparationRequired())return this._isPreparationRequired=!0,!0;return!1}prepare(t,e){return r(this,void 0,void 0,(function*(){for(const n of this.getChildNodes())yield n.prepare(t,e)}))}_getChildNodes(){return[]}getChildNodes(){return void 0===this.childNodes&&(this.childNodes=this._getChildNodes()),this.childNodes}findChildrenByType(t){return this.findChildrenByTypes([t])}findChildrenByTypes(t,e=null){if(null!==e&&this.nodeCache[e])return this.nodeCache[e];const n=[];for(const e of this.getChildNodes())for(const i of t){e instanceof i&&n.push(e);const t=e.findChildrenByType(i);n.push(...t)}return null!==e&&(this.nodeCache[e]=n),n}}e.Node=h;class p extends h{constructor(t){super(),this.statements=t}_getChildNodes(){return[...this.statements]}evaluate(t,e){return r(this,void 0,void 0,(function*(){let n=null;for(let i=0;i<this.statements.length;i++)n=yield this.statements[i].evaluate(t,e);return n}))}}e.BlockNode=p;class d extends h{constructor(t,e,n){super(),this.left=t,this.right=e,this.type=n}_getChildNodes(){return[this.left,this.right]}evaluate(t,e){return r(this,void 0,void 0,(function*(){const n=yield this.left.evaluate(t,e),i=yield this.right.evaluate(t,e);switch(this.type){case u.EQUALS:return n===i;case u.NOT_EQUALS:return n!==i;case u.GREATER_THAN:return n>i;case u.LESS_THAN:return n<i;case u.GREATER_THAN_EQUAL:return n>=i;case u.LESS_THAN_EQUAL:return n<=i}}))}static match(t){return[u.EQUALS,u.NOT_EQUALS,u.GREATER_THAN,u.LESS_THAN,u.GREATER_THAN_EQUAL,u.LESS_THAN_EQUAL].indexOf(t[0].type)>-1}static parse(t,e,n){return n.splice(0,1),new d(t,C.processTokens(C.getNextStatementTokens(n)),e.type)}}class f extends h{constructor(t,e){super(),this.condition=t,this.block=e}_getChildNodes(){return[this.condition,this.block]}evaluate(t,e){return r(this,void 0,void 0,(function*(){return(yield this.condition.evaluate(t,e))?yield this.block.evaluate(t,e):null}))}}class v extends h{constructor(t){super(),this.nodes=t}_getChildNodes(){return[...this.nodes]}evaluate(t,e){return r(this,void 0,void 0,(function*(){for(const n of this.nodes)if(yield n.condition.evaluate(t,e))return yield n.block.evaluate(t,e)}))}static parseConditional(t){if(-1===[u.IF,u.ELSE_IF].indexOf(t[0].type))throw SyntaxError("Invalid Syntax");return t.splice(0,1),new f(C.processTokens(C.getBlockTokens(t,null)[0]),C.processTokens(C.getBlockTokens(t,null)[0]))}static parse(t,e,n){if(n[1].type!==u.L_PAREN)throw SyntaxError("If statement needs to be followed by a condition encased in parenthesis.");const i=[];for(i.push(v.parseConditional(n));n.length>0&&u.ELSE_IF===n[0].type;)i.push(v.parseConditional(n));return n.length>0&&u.ELSE===n[0].type&&(n.splice(0,1),i.push(new f(new b(!0),C.processTokens(C.getBlockTokens(n,null)[0])))),new v(i)}}class y extends h{constructor(t,e,n){super(),this.variable=t,this.list=e,this.block=n}_getChildNodes(){return[this.variable,this.list,this.block]}evaluate(t,e){return r(this,void 0,void 0,(function*(){const n=yield this.variable.evaluate(t,e),i=yield this.list.evaluate(t,e);for(let r=0;r<i.length;r++)t.set(n,i[r]),yield this.block.evaluate(t,e);return null}))}static parse(t,e,n){if(n[1].type!==u.L_PAREN)throw SyntaxError("Syntax error: Missing (");if(n[3].type!==u.OF)throw SyntaxError("Syntax error: Missing of");n.splice(0,1);const i=C.getNextStatementTokens(n),r=i.splice(0,1)[0];i.splice(0,1);const s=C.processTokens(i),o=C.processTokens(C.getBlockTokens(n,null)[0]);return new y(new b(r.value),s,o)}}class g extends h{constructor(t){super(),this.toFlip=t}evaluate(t,e){return r(this,void 0,void 0,(function*(){return!(yield this.toFlip.evaluate(t,e))}))}_getChildNodes(){return[this.toFlip]}static parse(t,e,n){let i;return n.splice(0,1),i=n[0].type===u.L_PAREN?C.getNextStatementTokens(n):C.consumeTypes(n,[u.BOOLEAN_LITERAL,u.NUMBER_LITERAL,u.STRING_LITERAL,u.NAME,u.PERIOD]),new g(C.processTokens(i))}}class b extends h{constructor(t){super(),this.value=t}evaluate(t,e){return r(this,void 0,void 0,(function*(){return this.value}))}}class _ extends b{constructor(t){super(t),this.value=t,this.value="true"===t}}class m extends b{constructor(t){super(t),this.value=t,this.value.indexOf(".")>-1?this.value=parseFloat(this.value):this.value=parseInt(this.value)}}class A extends h{constructor(t,e){super(),this.fnc=t,this.args=e}_getChildNodes(){return[this.fnc,this.args]}evaluate(t,e){return r(this,void 0,void 0,(function*(){let n=t;this.fnc instanceof w&&(n=yield this.fnc.scope.evaluate(t,e));const i=yield this.args.evaluate(t,e);return(yield this.fnc.evaluate(t,e)).call(n.wrapped||n,...i)}))}}class E extends h{constructor(t){super(),this.args=t}_getChildNodes(){return[...this.args]}evaluate(t,e){return r(this,void 0,void 0,(function*(){const n=[];for(const i of this.args)n.push(yield i.evaluate(t,e));return n}))}}class w extends h{constructor(t,e){super(),this.scope=t,this.name=e}_getChildNodes(){return[this.scope,this.name]}evaluate(t,e){return r(this,void 0,void 0,(function*(){let n=[];const i=[];this.scope instanceof N?n=yield this.scope.evaluate(t,e):n.push(yield this.scope.evaluate(t,e));for(let r of n){if(r instanceof o.Tag&&(r=r.scope),!r)throw Error(`Cannot access "${yield this.name.evaluate(t,e)}" of undefined.`);const n=yield this.name.evaluate(t,e),a=r.get(n,!1);i.push(a instanceof s.Scope&&a.wrapped||a)}return 1===i.length?i[0]:i}))}}class T extends h{constructor(t){super(),this.name=t}_getChildNodes(){return[this.name]}evaluate(t,e){return r(this,void 0,void 0,(function*(){const n=t.get(yield this.name.evaluate(t,e));return n instanceof s.Scope&&n.wrapped||n}))}}class O extends h{constructor(t,e,n){super(),this.left=t,this.right=e,this.type=n}_getChildNodes(){return[this.left,this.right]}evaluate(t,e){return r(this,void 0,void 0,(function*(){const n=yield this.left.evaluate(t,e),i=yield this.right.evaluate(t,e);switch(this.type){case u.ADD:return n+i;case u.SUBTRACT:return n-i;case u.MULTIPLY:return n*i;case u.DIVIDE:return n/i}}))}static match(t){return[u.ADD,u.SUBTRACT,u.MULTIPLY,u.DIVIDE].indexOf(t[0].type)>-1}static parse(t,e,n){return n.splice(0,1),new O(t,C.processTokens(C.getNextStatementTokens(n)),e.type)}}class R extends h{constructor(t,e,n){super(),this.left=t,this.right=e,this.type=n}_getChildNodes(){return[this.left,this.right]}evaluate(t,e){return r(this,void 0,void 0,(function*(){let n=[];const i=yield this.left.name.evaluate(t,e);if(this.left instanceof w){const i=yield this.left.scope.evaluate(t,e);this.left.scope instanceof N?n.push(...i):n.push(i)}else this.left instanceof P?n=yield this.left.elementRef.evaluate(t,e):n.push(t);const r=[];for(let t of n){t instanceof o.Tag?t=t.scope:t.$wrapped&&t.$scope&&(t=t.$scope);let n=yield this.left.evaluate(t,e),s=yield this.right.evaluate(t,e);if(this.left instanceof P&&(n=n[0]),this.right instanceof P&&(s=s[0]),n instanceof Array){switch(s instanceof Array||(s=[s]),this.type){case u.ASSIGN:n.splice(0,n.length),n.push(...s);break;case u.ADD_ASSIGN:n.push(...s);break;case u.SUBTRACT_ASSIGN:for(let t=n.length-1;t>=0;t--)s.indexOf(n[t])>-1&&(n.splice(t,1),t++)}t.trigger(`change:${i}`)}else if(Number.isFinite(n)){switch(null===s||Number.isFinite(s)||(s=parseFloat(`${s}`)),n=n,s=s,this.type){case u.ASSIGN:n=s;break;case u.ADD_ASSIGN:n+=s;break;case u.SUBTRACT_ASSIGN:n-=s;break;case u.MULTIPLY_ASSIGN:n*=s;break;case u.DIVIDE_ASSIGN:n/=s}t.set(i,n)}else n=s,t.set(i,n);r.push(n)}return r.length>1?r:r[0]}))}static match(t){return[u.ASSIGN,u.ADD_ASSIGN,u.SUBTRACT_ASSIGN,u.MULTIPLY_ASSIGN,u.DIVIDE_ASSIGN].indexOf(t[0].type)>-1}static parsed(t,e,n){if(!(t instanceof T||t instanceof w||t instanceof P))throw SyntaxError("Invalid assignment syntax.");n.splice(0,1);const i=C.getNextStatementTokens(n);return new R(t,C.processTokens(i),e.type)}static parse(t,e,n){if(!(t instanceof T||t instanceof w||t instanceof P))throw SyntaxError(`Invalid assignment syntax near ${C.toCode(n.splice(0,10))}`);n.splice(0,1);const i=C.getNextStatementTokens(n,!1,!1,!0);return new R(t,C.processTokens(i),e.type)}}class S extends h{constructor(t,e,n=null){super(),this.object=t,this.index=e,this.indexTwo=n}_getChildNodes(){const t=[this.object,this.index];return this.indexTwo&&t.push(this.indexTwo),t}negativeIndex(t,e){return Number.isFinite(e)&&e<0?t.length+e:e}evaluate(t,e){return r(this,void 0,void 0,(function*(){const n=yield this.object.evaluate(t,e),i=this.negativeIndex(n,yield this.index.evaluate(t,e));if(Number.isFinite(i)&&this.indexTwo){const r=this.negativeIndex(n,yield this.indexTwo.evaluate(t,e)),s=[];for(let t=i;t<=r;t++)s.push(n[t]);return s}return n[i]}))}static match(t){return t[0].type===u.L_BRACKET}static parse(t,e,n){const i=C.getBlockTokens(n,u.COLON),r=[];for(const t of i)r.push(C.processTokens(t));return new S(t,r[0],r.length>1&&r[1])}}class k extends h{constructor(t){super(),this.values=t}_getChildNodes(){return new Array(...this.values)}evaluate(t,e){return r(this,void 0,void 0,(function*(){const n=[];for(const i of this.values)n.push(yield i.evaluate(t,e));return n}))}static match(t){return t[0].type===u.L_BRACKET}static parse(t,e,n){const i=C.getBlockTokens(n),r=[];for(const t of i)r.push(C.processTokens(t));return new k(r)}}class x extends h{constructor(t,e){super(),this.keys=t,this.values=e}_getChildNodes(){return new Array(...this.values)}evaluate(t,e){return r(this,void 0,void 0,(function*(){const n=new s.Scope;for(let i=0;i<this.values.length;i++){const r=this.keys[i],s=this.values[i];n.set(yield r.evaluate(t,e),yield s.evaluate(t,e))}return n}))}static match(t){return t[0].type===u.L_BRACE}static parse(t,e,n){const i=C.getNextStatementTokens(n),r=[],s=[];for(;i.length>0;){const t=C.getTokensUntil(i,u.COLON,!1);if(i[0].type!==u.COLON)throw Error("Invalid object literal syntax. Expecting :");i.splice(0,1);const e=C.getTokensUntil(i,u.COMMA,!0,!1,!0);r.push(C.processTokens(t)),s.push(C.processTokens(e))}return new x(r,s)}}class N extends h{constructor(t){super(),this.query=t,this.requiresPrep=!0}evaluate(t,e){return r(this,void 0,void 0,(function*(){return yield e.get(this.query,!0)}))}prepare(t,e){return r(this,void 0,void 0,(function*(){yield e.get(this.query,!0)}))}}class P extends h{constructor(t,e){super(),this.elementRef=t,this.attr=e,this.requiresPrep=!0}get name(){return new b(`@${this.attributeName}`)}_getChildNodes(){return[this.elementRef]}get attributeName(){return this.attr.startsWith(".")?this.attr.substring(2):this.attr.substring(1)}evaluate(t,e){return r(this,void 0,void 0,(function*(){return(yield this.elementRef.evaluate(t,e)).map((t=>t.scope.get(`@${this.attributeName}`)))}))}prepare(t,e){return r(this,void 0,void 0,(function*(){yield this.elementRef.prepare(t,e);const n=yield this.elementRef.evaluate(t,e);for(const t of n)yield t.watchAttribute(this.attributeName)}))}}e.AttributableNodes=[T,w,P];class C{constructor(t){this.code=t,C.cache[t]?this.rootNode=C.cache[t]:(this.parse(),C.cache[t]=this.rootNode)}parse(){const t=C.tokenize(this.code);this.rootNode=C.processTokens(t)}evaluate(t,e){return r(this,void 0,void 0,(function*(){return yield this.rootNode.evaluate(t,e)}))}prepare(t,e){return r(this,void 0,void 0,(function*(){if(this.rootNode.isPreparationRequired())return yield this.rootNode.prepare(t,e)}))}bindToScopeChanges(t,e){return r(this,void 0,void 0,(function*(){for(const n of this.rootNode.findChildrenByTypes([T,w],"ScopeMemberNodes")){let i=t;n instanceof w&&(i=yield n.scope.evaluate(t,null));const r=yield n.name.evaluate(t,null);i.bind(`change:${r}`,e)}}))}static tokenize(t){const e=[];if(!t||0===t.length)return e;let n;do{n=!1;for(const i of l){const r=i.pattern.exec(t);if(r){e.push({type:i.type,value:r[r.length-1]}),t=t.substring(r[0].length),n=!0;break}}}while(t.length>0&&n);return e}static stripWhiteSpace(t){for(let e=0;e<t.length;e++)t[e].type===u.WHITESPACE&&(t.splice(e,1),e--);return t}static processTokens(t){let e=[],n=null,i=0;for(C.stripWhiteSpace(t);t.length>0&&(i++,!(i>1e3));){t[0].type===u.RETURN&&t.splice(0,1);const i=t[0];if(i.type===u.NAME)n=new T(new b(i.value)),t.splice(0,1);else if(i.type===u.IF)n=v.parse(n,i,t),e.push(n),n=null;else if(i.type===u.FOR)n=y.parse(n,i,t),e.push(n),n=null;else if(i.type===u.STRING_LITERAL)n=new b(i.value),t.splice(0,1);else if(i.type===u.NUMBER_LITERAL)n=new m(i.value),t.splice(0,1);else if(t[0].type===u.ELEMENT_REFERENCE)n=new N(t[0].value),t.splice(0,1);else if(t[0].type===u.ELEMENT_QUERY)n=new N(t[0].value),t.splice(0,1);else if(t[0].type===u.L_BRACKET)n=n?S.parse(n,i,t):k.parse(n,i,t);else if(t[0].type===u.L_BRACE)n=x.parse(n,i,t);else if(t[0].type===u.ELEMENT_ATTRIBUTE&&n instanceof N)n=new P(n,t[0].value),t.splice(0,1);else if(null!==n&&i.type===u.PERIOD&&t[1].type===u.NAME)n=new w(n,new b(t[1].value)),t.splice(0,2);else if(t[0].type===u.L_PAREN){const e=C.getBlockTokens(t),i=[];for(const t of e)i.push(C.processTokens(t));n=n?new A(n,new E(i)):new p(i)}else if(t[0].type===u.SEMI_COLON)n&&e.push(n),n=null,t.splice(0,1);else if(d.match(t))n=d.parse(n,i,t);else if(O.match(t))n=O.parse(n,i,t);else if(R.match(t))n=R.parse(n,i,t);else if(t[0].type===u.WHITESPACE)t.splice(0,1);else if(t[0].type===u.BOOLEAN_LITERAL)n=new _(t[0].value),t.splice(0,1);else if(t[0].type===u.NULL_LITERAL)n=new b(null),t.splice(0,1);else{if(t[0].type!==u.EXCLAMATION_POINT){let e=C.toCode(t,10);throw Error(`Syntax Error. Near ${e}`)}n=g.parse(n,t[0],t)}}return n&&e.push(n),new p(e)}static toCode(t,e){let n="";e=e||t.length;for(let i=0;i<e&&t[i];i++)n+=t[i].value;return n}static getBlockInfo(t){let e;const n=t[0];let i,r,s,o;switch(e=n.type===u.L_PAREN?c.PAREN:n.type===u.L_BRACE?c.BRACE:n.type===u.L_BRACKET?c.BRACKET:c.STATEMENT,e){case c.PAREN:i=u.L_PAREN,r=u.R_PAREN,s="(",o=")";break;case c.BRACE:i=u.L_BRACE,r=u.R_BRACE,s="{",o="}";break;case c.BRACKET:i=u.L_BRACKET,r=u.R_BRACKET,s="[",o="]";break;default:i=null,r=u.SEMI_COLON,s=null,o=";"}return{type:e,open:i,close:r,openCharacter:s,closeCharacter:o}}static getNextStatementTokens(t,e=!0,n=!0,i=!1){const r=C.getBlockInfo(t);return n&&t[0].type===r.open&&t.splice(0,1),C.getTokensUntil(t,r.close,e,i)}static getBlockTokens(t,e=u.COMMA){const n=C.getBlockInfo(t);let i=0;const r=[];let s=[];for(let o=0;o<t.length;o++){const a=t[o];if(a.type===n.open?(i+=1,i>1&&s.push(a)):a.type===n.close?(i-=1,i>0&&s.push(a)):null!==e&&a.type===e&&1==i?(r.push(s),s=[]):a.type!==u.WHITESPACE&&s.push(a),t.splice(0,1),o--,0===i)return s.length>0&&r.push(s),r}throw Error(`Invalid Syntax, missing ${n.closeCharacter}`)}static getTokensUntil(t,e=u.SEMI_COLON,n=!0,i=!1,r=!1){const s=[],o=C.getBlockInfo(t);let a=0,c=0,l=0;for(let h=0;h<t.length;h++){const p=t[h];if(p.type===o.open&&0===h||(p.type===u.L_PAREN&&(a+=1),p.type===u.L_BRACE&&(c+=1),p.type===u.L_BRACKET&&(l+=1)),[e,u.R_BRACKET,u.R_BRACE,u.R_PAREN].indexOf(p.type)>-1)if(a>0&&p.type===u.R_PAREN)a-=1;else if(c>0&&p.type===u.R_BRACE)c-=1;else{if(!(l>0&&p.type===u.R_BRACKET)){if(0===a&&0===c&&0===l&&p.type===e){i&&s.push(p),(i||n)&&p.type!==u.SEMI_COLON&&t.splice(0,1);break}if(r)break;throw Error(`Invalid syntax, expecting ${e}.`)}l-=1}s.push(p),t.splice(0,1),h--}return s}static consumeTypes(t,e){const n=[];for(const i of t){if(!(e.indexOf(i.type)>-1))break;n.push(i)}return t.splice(0,n.length),n}}C.cache={},i([a.benchmark("AST","parse")],C.prototype,"parse",null),i([a.benchmarkAsync("AST","evaluate")],C.prototype,"evaluate",null),i([a.benchmarkAsync("AST","prepare")],C.prototype,"prepare",null),i([a.benchmarkAsync("AST","bindToScopeChanges")],C.prototype,"bindToScopeChanges",null),i([a.benchmark("AST","tokenize")],C,"tokenize",null),i([a.benchmark("AST","stripWhiteSpace")],C,"stripWhiteSpace",null),i([a.benchmark("AST","processTokens")],C,"processTokens",null),i([a.benchmark("AST","getBlockInfo")],C,"getBlockInfo",null),i([a.benchmark("AST","getNextStatementTokens")],C,"getNextStatementTokens",null),i([a.benchmark("AST","getBlockTokens")],C,"getBlockTokens",null),i([a.benchmark("AST","getTokensUntil")],C,"getTokensUntil",null),i([a.benchmark("AST","consumeTypes")],C,"consumeTypes",null),e.Tree=C},5092:function(t,e,n){var i=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.Attribute=void 0;const r=n(4264);class s{constructor(t,e){this.tag=t,this.attributeName=e,this.configure(),r.VisionHelper.window&&r.VisionHelper.window.Attributes.push(this),s.cache[e]=this}configure(){return i(this,void 0,void 0,(function*(){}))}compile(){return i(this,void 0,void 0,(function*(){}))}setup(){return i(this,void 0,void 0,(function*(){}))}extract(){return i(this,void 0,void 0,(function*(){}))}connect(){return i(this,void 0,void 0,(function*(){}))}evaluate(){return i(this,void 0,void 0,(function*(){}))}getAttributeValue(t=null){return this.tag.getRawAttributeValue(this.attributeName,t)}getAttributeBinding(t=null){return this.tag.getAttributeBinding(this.attributeName)||t}getAttributeModifiers(t=[]){const e=this.tag.getAttributeModifiers(this.attributeName);return e.length&&e||t}hasModifier(t){return this.getAttributeModifiers().indexOf(t)>-1}mutate(t){}set value(t){this.tag.element.setAttribute(this.attributeName,t)}get value(){return this.tag.element.getAttribute(this.attributeName)||""}}e.Attribute=s,s.scoped=!1,s.cache={}},44:function(t,e,n){var i=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.benchmarkResultsAll=e.benchmarkResultsMatch=e.benchmarkResults=e.benchmarkEnd=e.benchmarkStart=e.benchmarkAsync=e.benchmark=e.benchmarkClass=e.BENCHMARKS=void 0;const r=n(4264);e.BENCHMARKS=[];const s={};function o(t){return(t=t instanceof Array?t:t&&[t]||[]).map((t=>t.toLowerCase()))}function a(t,e){return(e=[...o(e)]).sort(),e.length&&`${t}.${e.join(".")}`.toLowerCase()||t&&t.toLowerCase()||"nopath"}function c(t,e,n,i=null){return(i instanceof Date||Number.isFinite(i))&&(!Number.isFinite(n)&&n instanceof Date&&(n=n.getTime()),!Number.isFinite(i)&&i instanceof Date&&(i=i.getTime()),n=i-n),{name:t,tags:e=o(e),path:a(t,e),time:n}}function u(t,e){t=o(t),e=o(e);for(const n in e)if(-1===t.indexOf(n))return!1;return!0}function l(t,n,i=!1){return function(s,a,u){if(r.VisionHelper.doBenchmark){const r=u.value;u.value=function(){console.log(s,s.__BENCHMARK_NAME__),t=s.__BENCHMARK_NAME__||t||a,n=o(n),(s.__BENCHMARK_NAME__||s.__BENCHMARK_TAGS__)&&(n.push(t||a),n.push(...s.__BENCHMARK_TAGS__)),console.log(t,n);const u=new Date,l=r.apply(this,arguments),h=new Date,p=c(t,n,u,h);return e.BENCHMARKS.push(p),i&&console.log(p),l}}}}function h(t,e){r.VisionHelper.doBenchmark&&(t=a(t,e),s[t]=new Date)}function p(t,n,i=null){if(r.VisionHelper.doBenchmark){const r=a(t,n),o=c(t,n,s[r],new Date);if(e.BENCHMARKS.push(o),i||null===i&&o.time>10){const e=o.path?`${t}[${o.path}]`:t;console.warn(`${e} took ${o.time}ms to complete.`)}return h(t),o}}function d(t,n=null){if(r.VisionHelper.doBenchmark){const i=a(t,n);let r=0,s=0;for(const o of e.BENCHMARKS)(!n&&o.name===t||o.path===i||!t&&u(o.tags,n))&&(r++,s+=o.time);return{name:t,calls:r,time:s,average:s/r}}}function f(t){if(r.VisionHelper.doBenchmark){const n={};let i=0,r=0;for(const s of e.BENCHMARKS)t.test(s.name)&&!n[s.name]&&(n[s.name]=d(s.name),i+=n[s.name].calls,r+=n[s.name].time);return n.ALL={name:"ALL",calls:i,time:r,average:r/i},n}}function v(){if(r.VisionHelper.doBenchmark){const t={};let n=0,i=0;for(const r of e.BENCHMARKS)if(!t[r.name]){const e=r.path?`${r.name}.${r.path}`:r.name;t[e]=d(r.name,r.tags),n+=t[e].calls,i+=t[e].time}return t.ALL={name:"ALL",calls:n,time:i,average:i/n},t}}e.benchmarkClass=function(t,e){return function(n){return class extends n{constructor(){super(...arguments),this.__BENCHMARK_NAME__=t,this.__BENCHMARK_TAGS__=e}}}},e.benchmark=l,e.benchmarkAsync=function(t,n,s=!1){return function(o,a,u){if(r.VisionHelper.doBenchmark){t=t||a;const r=u.value;u.value=function(){return i(this,arguments,void 0,(function*(){const i=new Date,o=yield r.apply(this,arguments),a=new Date,u=c(t,n,i,a);return e.BENCHMARKS.push(u),s&&console.log(u),o}))}}}},e.benchmarkStart=h,e.benchmarkEnd=p,e.benchmarkResults=d,e.benchmarkResultsMatch=f,e.benchmarkResultsAll=v,r.VisionHelper.doBenchmark&&r.VisionHelper.window&&(window.benchmark=l,window.benchmarks=e.BENCHMARKS,window.benchmarkStart=h,window.benchmarkEnd=p,window.benchmarkResults=d,window.benchmarkResultsMatch=f,window.benchmarkResultsAll=v)},6417:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Configuration=void 0;const i=n(8294),r=n(4264);class s extends i.EventDispatcher{constructor(){super(),this.data=r.VisionHelper.window&&window.$configuration||{}}get(t,e=null){return void 0===this.data[t]?e:this.data[t]}set(t,e){const n=this.data[t];this.data[t]=e,this.trigger(`change:${t}`,{value:e,previous:n}),this.trigger("change",{key:t,value:e,previous:n})}static set(t,e){s.instance.set(t,e)}static get(t,e=null){return s.instance.get(t,e)}static get instance(){return s._instance||(s._instance=new s),s._instance}}e.Configuration=s},9033:function(t,e,n){var i,r=this&&this.__decorate||function(t,e,n,i){var r,s=arguments.length,o=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,n,o):r(e,n))||o);return s>3&&o&&Object.defineProperty(e,n,o),o},s=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.DOM=void 0;const o=n(712),a=n(2712),c=n(8294),u=n(6417),l=n(7754),h=n(1008),p=n(44),d=n(4264);let f=i=class extends c.EventDispatcher{constructor(t,e=!0,n=!1){super(),this.rootElement=t,this.debug=n,this.queued=[],this.observer=new MutationObserver(this.mutation.bind(this)),this.tags=[],e&&this.buildFrom(t,!0),this.evaluate(),u.Configuration.instance.bind("change",this.evaluate.bind(this))}get(t,e=!1){return s(this,void 0,void 0,(function*(){const n=this.querySelectorAll(t);return yield this.getTagsForElement(Array.from(n),e)}))}registerElementInRoot(t){const e=t.element.getAttribute("id");e&&this.root.scope.set(`#${e}`,t.scope)}querySelectorAll(t){return this.rootElement.querySelectorAll(t)}querySelector(t){return this.rootElement.querySelector(t)}eval(t){return s(this,void 0,void 0,(function*(){const e=new l.Tree(t);return yield e.prepare(this.root.scope,this),yield e.evaluate(this.root.scope,this)}))}evaluate(){return s(this,void 0,void 0,(function*(){clearTimeout(this.evaluateTimeout);for(const t of this.tags)yield t.evaluate()}))}mutation(t){return s(this,void 0,void 0,(function*(){for(const e of t){const t=yield this.getTagForElement(e.target);t&&t.mutate(e)}}))}buildFrom(t,e=!1){return s(this,void 0,void 0,(function*(){const n=[];e&&(document.body.setAttribute("vsn-root",""),document.ondragover=t=>t.preventDefault());for(const t of this.tags)n.push(t.element);const i=[],r=[];if(d.VisionHelper.doBenchmark&&p.benchmarkStart("DOM","findElements"),t&&t.querySelectorAll)for(const e of Array.from(t.querySelectorAll("*")))a.ElementHelper.hasVisionAttribute(e)&&(this.queued.indexOf(e)>-1||(this.queued.push(e),r.push(e)));d.VisionHelper.doBenchmark&&p.benchmarkEnd("DOM","findElements"),d.VisionHelper.doBenchmark&&p.benchmarkStart("DOM","buildTags");for(const t of r){if(n.indexOf(t)>-1)continue;const e=new o.Tag(t,this);this.tags.push(e),i.push(e),n.push(t)}d.VisionHelper.doBenchmark&&p.benchmarkEnd("DOM","buildTags"),e&&(this.root=yield this.getTagForElement(document.body)),d.VisionHelper.doBenchmark&&p.benchmarkStart("DOM","buildTagAttributes");for(const t of i)yield t.buildAttributes();d.VisionHelper.doBenchmark&&p.benchmarkEnd("DOM","buildTagAttributes"),d.VisionHelper.inDevelopment&&p.benchmarkStart("DOM","compileAttributes");for(const t of i)yield t.compileAttributes();d.VisionHelper.doBenchmark&&p.benchmarkEnd("DOM","compileAttributes"),d.VisionHelper.doBenchmark&&p.benchmarkStart("DOM","buildTree");for(const t of i){if(t===this.root)continue;let e=t.element.parentElement,i=!1;for(;e;){if(n.indexOf(e)>-1){i=!0,t.parentTag=yield this.getTagForElement(e);break}e=e.parentElement}i||console.error("Could not find parent for ",t)}d.VisionHelper.doBenchmark&&p.benchmarkEnd("DOM","buildTree"),d.VisionHelper.doBenchmark&&p.benchmarkStart("DOM","setupAttributes");for(const t of i)yield t.setupAttributes();d.VisionHelper.doBenchmark&&p.benchmarkEnd("DOM","setupAttributes"),d.VisionHelper.doBenchmark&&p.benchmarkStart("DOM","extractAttributes");for(const t of i)yield t.extractAttributes();d.VisionHelper.doBenchmark&&p.benchmarkEnd("DOM","extractAttributes"),d.VisionHelper.doBenchmark&&p.benchmarkStart("DOM","connectAttributes");for(const t of i)yield t.connectAttributes();d.VisionHelper.doBenchmark&&p.benchmarkEnd("DOM","connectAttributes"),d.VisionHelper.doBenchmark&&p.benchmarkStart("DOM","finalizeTags");for(const t of i)yield t.finalize(),this.queued.splice(this.queued.indexOf(t.element),1);d.VisionHelper.doBenchmark&&p.benchmarkEnd("DOM","finalizeTags"),d.VisionHelper.doBenchmark&&p.benchmarkStart("DOM","observeTags");for(const t of i)this.observer.observe(t.element,{attributes:!0,characterData:!0,childList:!0,subtree:!0});d.VisionHelper.doBenchmark&&p.benchmarkEnd("DOM","observeTags"),this.trigger("built")}))}getTagsForElement(t,e=!1){return s(this,void 0,void 0,(function*(){const n=new h.TagList,i=[];for(const e of this.tags)t.indexOf(e.element)>-1&&(n.push(e),i.push(e.element));if(e){const r=[...t];for(let t=r.length;t>=0;t--){const e=r[t];i.indexOf(e)>-1&&r.pop()}for(const t of r)n.push(yield this.getTagForElement(t,e))}return n}))}getTagForElement(t,e=!1){return s(this,void 0,void 0,(function*(){for(const e of this.tags)if(e.element===t)return e;return t&&e?(t.setAttribute("vsn-ref",""),yield this.buildFrom(t.parentElement),yield this.getTagForElement(t,!1)):null}))}static get instance(){return i._instance||(i._instance=new i(document,!1,!1)),i._instance}};r([p.benchmark()],f.prototype,"buildFrom",null),f=i=r([p.benchmarkClass("DOM")],f),e.DOM=f},6846:function(t,e,n){var i=this&&this.__decorate||function(t,e,n,i){var r,s=arguments.length,o=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,n,o):r(e,n))||o);return s>3&&o&&Object.defineProperty(e,n,o),o};Object.defineProperty(e,"__esModule",{value:!0}),e.Formats=void 0;const r=n(1371),s=n(6417);class o{static currency(t){if(!o.CurrencyFormatter){const t=()=>{const t=s.Configuration.get("locale","en-US"),e=s.Configuration.get("currency","USD");o.CurrencyFormatter=new Intl.NumberFormat(t,{style:"currency",currency:e})};s.Configuration.instance.bind("change:locale",t),s.Configuration.instance.bind("change:currency",t),t()}return t=`${t}`.replace(/[^0-9.]+/,""),o.CurrencyFormatter.format(parseFloat(t))}static date(t){return t?t.toLocaleString():""}}i([r.Registry.format("currency")],o,"currency",null),i([r.Registry.format("date")],o,"date",null),e.Formats=o},7677:function(t,e,n){var i=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.Query=void 0;const r=n(1008),s=n(4264),o=n(9033);e.Query=function(t,e=null){return i(this,void 0,void 0,(function*(){return s.VisionHelper.document?(e=e||o.DOM.instance,yield e.get(t,!0)):new r.TagList}))}},1371:function(t,e,n){var i=this&&this.__decorate||function(t,e,n,i){var r,s=arguments.length,o=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,n,o):r(e,n))||o);return s>3&&o&&Object.defineProperty(e,n,o),o};Object.defineProperty(e,"__esModule",{value:!0}),e.Registry=e.RegistryStore=e.register=void 0;const r=n(8294),s=n(8513),o=n(4264),a=n(44);function c(t,e=null,n=null){return function(i,r=null){e=e||i.prototype.constructor.name,null!==r&&(i=i[r]),l.instance[t].register(e,i),n&&n()}}e.register=c;class u extends r.EventDispatcher{constructor(t=null){super(),this.timeouts={},this.store=t||{}}register(t,e){this.store[t]=e,this.trigger(`registered:${t}`,e)}get(t){const e=s.Promise.defer();return this.store[t]?e.resolve(this.store[t]):(console.warn(`Waiting for ${t} to be registered.`),this.timeouts[t]=setTimeout((()=>{console.warn(`RegistryStore.get timed out after 5 seconds trying to find ${t}. Make sure the item is registered.`)}),5e3),this.once(`registered:${t}`,(n=>{clearTimeout(this.timeouts[t]),e.resolve(n)}))),e.promise}getSynchronous(t){return this.store[t]}}i([a.benchmark("RegistryStore.get")],u.prototype,"get",null),e.RegistryStore=u;class l extends r.EventDispatcher{constructor(){super();const t=o.VisionHelper.window||{};this.classes=new u(t.$classes||{}),this.models=new u(t.$models||{}),this.templates=new u(t.$templates||{}),this.types=new u(t.$types||{}),this.formats=new u(t.$formats||{}),this.attributes=new u(t.$attributes||{})}static class(t=null,e=null){return c("classes",t,e)}static model(t=null,e=null){return c("models",t,e)}static template(t=null,e=null){return c("templates",t,e)}static type(t=null,e=null){return c("types",t,e)}static format(t=null,e=null){return c("formats",t,e)}static attribute(t=null,e=null){return c("attributes",t,e)}static get instance(){return l._instance||(l._instance=new l),l._instance}}e.Registry=l},4843:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Scope=e.WrappedArray=e.ScopeVariableType=e.ScopeReference=void 0;const i=n(6586),r=n(8294),s=n(1371);class o{constructor(t,e,n){this.scope=t,this.key=e,this.value=n}}e.ScopeReference=o;class a{}e.ScopeVariableType=a,a.Integer="integer",a.Float="float",a.Boolean="boolean",a.String="string";class c extends Array{constructor(...t){super(...t),this.$wrapped=!0,Object.setPrototypeOf(this,c.prototype),this._lastKey=0,this._listeners={}}push(...t){const e=super.push(...t);this.trigger("push",...t);for(const e of t)this.trigger("add",e);return e}splice(t,e){const n=super.splice(t,e);for(const t of n)this.trigger("remove",t);return n}get length(){let t=0;for(const e of this)t+=1;return t}set length(t){let e=0;const n=[];for(const i of this)e+=1,e>=t&&n.push(i);for(const t of n)this.splice(this.indexOf(t),1),this.trigger("remove",t)}bind(t,e,n,i){return i=i||!1,this._lastKey++,this._listeners[t]=this._listeners[t]||[],this._listeners[t].push(new r.EventCallback(e,this._lastKey,i,n)),this._lastKey}once(t,e,n){return this.bind(t,e,n,!0)}unbind(t,e){if(!(t in this._listeners))return!1;if(!e)return this._listeners[t]=[],!0;for(const n of this._listeners[t])if(e==n.key)return this._listeners[t].splice(this._listeners[t].indexOf(n),1),!0;return!1}unbindWithContext(t,e){if(!(t in this._listeners))return 0;let n=[],i=0;for(const i of this._listeners[t])e==i.context&&n.push(i);for(const e of n)this._listeners[t].splice(this._listeners[t].indexOf(e),1),i++;return i}getListener(t,e){for(const n of this._listeners[t])if(e==n.key)return n}trigger(t,...e){if(t in this._listeners)for(let n=0;n<this._listeners[t].length;n++){const i=this._listeners[t][n];i.once&&(this.unbind(t,i.key),n--),i.call(e)}}}e.WrappedArray=c;class u extends r.EventDispatcher{constructor(t){super(),this.types={},t&&(this.parentScope=t),this.children=[],this.data=new i.DataModel({}),this.keys=[]}get parentScope(){return this._parentScope}set parentScope(t){this._parentScope=t,t.addChild(this)}addChild(t){this.children.push(t)}getReference(t,e=!0){const n=t.split(".");let i=n[0],r=this,s=null,a=n.length;for(let t=0;t<a;t++){i=n[t],s=r.get(i,0===t);const o=[null,void 0].indexOf(s)>-1;if(e&&o&&t+1<a)s=new u(r),r.set(i,s);else if(!e&&o)return null;s&&s instanceof u&&(r=s)}return new o(r,i,s)}get(t,e=!0){return void 0===this.data[t]?e&&this.parentScope?this.parentScope.get(t,e):"":this.data[t]}set(t,e){if(void 0===this.data[t]&&this.data.createField(t),"string"==typeof e){const n=this.getType(t),i=s.Registry.instance.types.getSynchronous(n);i&&(e=i(e)),[a.Integer,a.Float].indexOf(n)>-1&&isNaN(e)&&(e=null)}if(this.data[t]!==e){const n=this.data[t];this.data[t]=e;const i={value:e,previousValue:n,key:t};this.trigger(`change:${t}`,i),this.trigger("change",t,i)}-1===this.keys.indexOf(t)&&this.keys.push(t)}has(t){return this.keys.indexOf(t)>-1}setType(t,e){this.types[t]=e,this.has(t)&&this.set(t,this.get(t))}getType(t){return this.types[t]||a.String}extend(t){for(const e of t)this.set(e,t[e])}clear(){for(const t of this.keys)["function","object"].indexOf(typeof this.get(t))>-1||this.set(t,null)}cleanup(){this.children.length=0,this.parentScope=null}setData(t){for(const e in t)this.set(e,t[e])}wrap(t,e=!1,n=!0){if(t instanceof u&&(t=t.data),-1===[null,void 0].indexOf(this.wrapped))throw Error("A scope can only wrap a single object");if(!t)throw Error("Can only wrap objects.");if(t.$wrapped)throw Error("An object should only be wrapped once.");this.wrapped=t,this.wrapped.$wrapped=!0;for(const i in t){if(["constructor"].indexOf(i)>-1||i.startsWith("$"))continue;if(this.wrapped[i]instanceof Function){this.set(i,this.wrapped[i]);continue}this.wrapped[i]instanceof Array&&!(this.wrapped[i]instanceof c)&&(this.wrapped[i]=new c(...t[i])),n&&-1===[null,void 0].indexOf(this.wrapped[i])&&this.set(i,this.wrapped[i]);const r=()=>this.get(i),s=t=>{this.set(i,t)};Object.defineProperty(this.wrapped,i,{get:r,set:s,enumerable:!0,configurable:!0}),e&&this.trigger(`change:${i}`)}this.wrapped.get=this.get.bind(this),this.wrapped.set=this.set.bind(this),this.wrapped.bind=this.bind.bind(this),this.wrapped.once=this.once.bind(this),this.wrapped.unbind=this.unbind.bind(this)}unwrap(){if(!this.wrapped)return;const t=this.wrapped;this.wrapped=null,t.$wrapped=!1;for(const e in t)delete t[e]}}e.Scope=u},712:function(t,e,n){var i=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.Tag=e.TagState=void 0;const r=n(4843),s=n(8294),o=n(4264),a=n(6032),c=n(8447),u=n(1371),l=n(44);var h;!function(t){t[t.Instantiated=0]="Instantiated",t[t.AttributesBuilt=1]="AttributesBuilt",t[t.AttributesCompiled=2]="AttributesCompiled",t[t.AttributesSetup=3]="AttributesSetup",t[t.AttributesExtracted=4]="AttributesExtracted",t[t.AttributesConnected=5]="AttributesConnected",t[t.Built=6]="Built"}(h=e.TagState||(e.TagState={}));class p extends s.EventDispatcher{constructor(t,e){super(),this.element=t,this.dom=e,this._children=[],this.inputTags=["input","select","textarea"],this._uniqueScope=!1,this.rawAttributes={},this.parsedAttributes={},this.attributes=[],this.onEventHandlers={},this.analyzeElementAttributes(),this._state=h.Instantiated,o.VisionHelper.window&&(o.VisionHelper.window.Tags||(o.VisionHelper.window.Tags=[],o.VisionHelper.window.Attributes=[]),o.VisionHelper.window.Tags.push(this))}get uniqueScope(){return this._uniqueScope}get style(){return this.element.style}get computedStyle(){return o.VisionHelper.window&&window.getComputedStyle(this.element)||null}analyzeElementAttributes(){if(this.element.attributes&&!(this.element.attributes.length<=0))for(let t=0;t<this.element.attributes.length;t++){const e=this.element.attributes[t];if(this.rawAttributes[e.name]=e.value,e.name.indexOf(":")>-1){const t=e.name.split(":"),n=t.slice(1);n.push(e.value),this.parsedAttributes[t[0]]=n}else this.parsedAttributes[e.name]=[null,e.value]}}evaluate(){return i(this,void 0,void 0,(function*(){for(const t of this.attributes)yield t.evaluate()}))}mutate(t){for(const e of this.attributes)e.mutate(t);this.trigger("mutate",t)}get(t){this.element.getAttribute(t)}set(t,e){this.element.setAttribute(t,e)}getAttributeClass(t){return i(this,void 0,void 0,(function*(){return t.startsWith("vsn-")?(t=this.getAttributeName(t),u.Registry.instance.attributes.get(t)):null}))}getAttributeName(t){if((t=t.split("|")[0]).indexOf(":")>-1){const e=t.split(":");t=e[0]}return t}getAttributeBinding(t){return(t=t.split("|")[0]).indexOf(":")>-1?t.split(":")[1]:null}getAttributeModifiers(t){return t.split("|").splice(1)}get isInput(){return this.inputTags.indexOf(this.element.tagName.toLowerCase())>-1}set value(t){this.isInput?(this.element.setAttribute("value",t),this.element.value=t):this.element.innerText=t}get value(){return this.isInput?this.element.value:this.element.textContent}addChild(t){this._children.push(t)}get children(){return[...this._children]}get parentTag(){return this._parentTag}set parentTag(t){this.element!==document.body&&(this._parentTag=t,t.addChild(this),this.scope!==t.scope&&(this.scope.parentScope=t.scope))}get scope(){return this._scope?this._scope:this._parentTag?this._parentTag.scope:null}set scope(t){this._scope=t}get controller(){return this._controller}set controller(t){this._controller=t}wrap(t,e=!1,n=!0){return o.VisionHelper.isConstructor(t)&&(t=new t),this.scope.wrap(t,e,n),t.$scope=this.scope,t.$tag=this,t.$el=this.element,t}unwrap(){this.scope.unwrap()}removeFromDOM(){this.element.remove()}addToParentElement(){this._parentTag.element.appendChild(this.element)}hide(){this.element.hidden=!0}show(){this.element.hidden=!1}findAncestorByAttribute(t){return this.hasAttribute(t)?this:this.parentTag?this.parentTag.findAncestorByAttribute(t):null}hasAttribute(t){return!!this.parsedAttributes[t]}getAttribute(t){return i(this,void 0,void 0,(function*(){const e=yield u.Registry.instance.attributes.get(t);if(e)for(const t of this.attributes)if(t instanceof e)return t}))}getRawAttributeValue(t,e=null){return this.rawAttributes[t]&&this.rawAttributes[t]||e}getParsedAttributeValue(t,e=0,n=null){return this.parsedAttributes[t]&&this.parsedAttributes[t][e]||n}buildAttributes(){return i(this,void 0,void 0,(function*(){let t=!1;this.attributes.length=0;const e=o.VisionHelper.isMobile();for(let n in this.rawAttributes){if(this.hasModifier(n,"mobile")&&!e)continue;if(this.hasModifier(n,"desktop")&&e)continue;const i=yield this.getAttributeClass(n);if(i){i.scoped&&(t=!0);const e=new i(this,n);this.attributes.push(e)}}this.element.getAttribute("id")&&(t=!0),t&&!this.uniqueScope&&(this._uniqueScope=!0,this._scope=new r.Scope),this._state=h.AttributesBuilt}))}compileAttributes(){return i(this,void 0,void 0,(function*(){for(const t of this.attributes)yield t.compile();this._state=h.AttributesCompiled}))}setupAttributes(){return i(this,void 0,void 0,(function*(){o.VisionHelper.doBenchmark&&l.benchmarkStart("Tag.setupAttributes");for(const t of this.attributes)yield t.setup();o.VisionHelper.doBenchmark&&l.benchmarkEnd("Tag.setupAttributes","Attribute.setup"),this.dom.registerElementInRoot(this),o.VisionHelper.doBenchmark&&l.benchmarkEnd("Tag.setupAttributes","register"),this._state=h.AttributesSetup,this.callOnWrapped("$setup"),o.VisionHelper.doBenchmark&&l.benchmarkEnd("Tag.setupAttributes","$setup")}))}extractAttributes(){return i(this,void 0,void 0,(function*(){for(const t of this.attributes)yield t.extract();this._state=h.AttributesExtracted,this.callOnWrapped("$extracted")}))}connectAttributes(){return i(this,void 0,void 0,(function*(){this.isInput&&this.addEventHandler("input",[],this.inputMutation.bind(this));for(const t of this.attributes)yield t.connect();this._state=h.AttributesConnected,this.callOnWrapped("$bound")}))}inputMutation(t){this.element.setAttribute("value",t.target.value)}finalize(){this._state=h.Built,this.callOnWrapped("$built",this,this.scope,this.element)}callOnWrapped(t,...e){return!!(this._uniqueScope&&this.scope&&this.scope.wrapped&&this.scope.wrapped[t])&&(this.scope.wrapped[t](...e),!0)}handleEvent(t,e){if(e&&e.stopPropagation(),this.onEventHandlers[t]){this.scope.set("$event",e),this.scope.set("$value",this.value);for(const n of this.onEventHandlers[t])n(e)}}hasModifier(t,e){return t.indexOf(`|${e}`)>-1}stripModifier(t,e){return t.replace(`|${e}`,"")}addEventHandler(t,e,n){let i=null;if(e.indexOf("active")>-1?i=!1:e.indexOf("passive")>-1&&(i=!0),!this.onEventHandlers[t]){this.onEventHandlers[t]=[];const e=c.On.WindowEvents.indexOf(t)>-1&&window?window:this.element,n={};(t.indexOf("touch")>-1||null!==i)&&(n.passive=null===i||i),e.addEventListener(t,this.handleEvent.bind(this,t),n)}this.onEventHandlers[t].push(n)}watchAttribute(t){return i(this,void 0,void 0,(function*(){for(const e of this.attributes)if(e instanceof a.StandardAttribute&&e.attributeName==t)return e;this.uniqueScope||(this._uniqueScope=!0,this._scope=new r.Scope,this.parentTag&&(this.scope.parentScope=this.parentTag.scope));const e=new a.StandardAttribute(this,t);return this.attributes.push(e),yield e.compile(),yield e.setup(),yield e.extract(),yield e.connect(),e}))}}e.Tag=p},1008:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TagList=void 0;const i=n(4264);class r extends Array{}e.TagList=r,i.VisionHelper.inDevelopment&&i.VisionHelper.window&&(window.TagList=r)},3398:function(t,e,n){var i=this&&this.__decorate||function(t,e,n,i){var r,s=arguments.length,o=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,n,o):r(e,n))||o);return s>3&&o&&Object.defineProperty(e,n,o),o};Object.defineProperty(e,"__esModule",{value:!0}),e.Types=void 0;const r=n(1371);class s{static string(t){return t}static integer(t){return parseInt(t)}static float(t){return t=`${t}`.replace(/[^0-9.]+/,""),parseFloat(t)}static boolean(t){return-1===[0,"0","false",""].indexOf(t)}static date(t){return new Date(Date.parse(t))}}i([r.Registry.type("string")],s,"string",null),i([r.Registry.type("integer")],s,"integer",null),i([r.Registry.type("float")],s,"float",null),i([r.Registry.type("boolean")],s,"boolean",null),i([r.Registry.type("date")],s,"date",null),e.Types=s},8943:function(t,e,n){var i=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.vision=e.Vision=void 0;const r=n(9033),s=n(8294),o=n(4843),a=n(6586),c=n(1371);n(3398),n(6846),n(2132);const u=n(6417),l=n(4264),h=n(7754),p=n(7677);class d extends s.EventDispatcher{constructor(){super(),this.registry=c.Registry.instance,this.config=u.Configuration.instance,l.VisionHelper.document?document.addEventListener("DOMContentLoaded",this.setup.bind(this)):console.warn("No dom, running in CLI mode."),this.registry.classes.register("Object",Object),this.registry.classes.register("WrappedArray",o.WrappedArray),this.registry.classes.register("DataModel",a.DataModel),l.VisionHelper.window&&(window.Vision=d,window.vision=window.vsn=this,window.Tree=h.Tree,window.$=p.Query,l.VisionHelper.window.dispatchEvent(new Event("vsn")))}get dom(){return this._dom}eval(t){return i(this,void 0,void 0,(function*(){return yield this._dom.eval(t)}))}setup(){return i(this,void 0,void 0,(function*(){document.body.setAttribute("vsn-root",""),this._dom=r.DOM.instance;const t=(new Date).getTime();yield this._dom.buildFrom(document,!0),console.warn(`Took ${(new Date).getTime()-t}ms to start up VisionJS`)}))}static get instance(){return d._instance||(d._instance=new d),d._instance}}e.Vision=d,e.vision=d.instance},8041:function(t,e,n){var i=this&&this.__decorate||function(t,e,n,i){var r,s=arguments.length,o=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,n,o):r(e,n))||o);return s>3&&o&&Object.defineProperty(e,n,o),o},r=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.AddClassIf=void 0;const s=n(523),o=n(1371);let a=class extends s.If{onChange(){return r(this,void 0,void 0,(function*(){(yield this.tree.evaluate(this.tag.scope,this.tag.dom))?this.tag.element.classList.add(this.getAttributeBinding()):this.tag.element.classList.remove(this.getAttributeBinding())}))}};a=i([o.Registry.attribute("vsn-add-class-if")],a),e.AddClassIf=a},8171:function(t,e,n){var i=this&&this.__decorate||function(t,e,n,i){var r,s=arguments.length,o=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,n,o):r(e,n))||o);return s>3&&o&&Object.defineProperty(e,n,o),o},r=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.Bind=void 0;const s=n(5092),o=n(7754),a=n(1371),c=n(44);let u=class extends s.Attribute{constructor(){super(...arguments),this.direction="both",this.formatter=t=>t}compile(){return r(this,void 0,void 0,(function*(){const t=new o.Tree(this.getAttributeValue());yield t.prepare(this.tag.scope,this.tag.dom)}))}setup(){return r(this,void 0,void 0,(function*(){this.property=this.getAttributeBinding();const t=this.getAttributeModifiers();t.length&&(t.indexOf("from")>-1?this.direction="from":t.indexOf("to")>-1&&(this.direction="to"))}))}extract(){return r(this,void 0,void 0,(function*(){let t,e=this.getAttributeValue();try{t=this.tag.scope.getReference(e)}catch(t){return void console.error("error",t)}this.key=t.key,this.boundScope=t.scope,this.valueFromElement&&this.updateFrom()}))}connect(){return r(this,void 0,void 0,(function*(){this.doUpdateTo&&(this.updateTo(),this.boundScope.bind(`change:${this.key}`,this.updateTo,this))}))}evaluate(){return r(this,void 0,void 0,(function*(){this.valueFromElement&&this.updateFrom(),this.updateTo()}))}set value(t){this.boundScope&&this.boundScope.set(this.key,t)}get value(){return this.boundScope?this.boundScope.get(this.key,!1):null}get valueFromElement(){let t;return t=this.property?this.tag.element.getAttribute(this.property):this.tag.value,t}mutate(t){super.mutate(t),this.doUpdateFrom&&(!this.property&&["characterData","childList"].indexOf(t.type)>-1?this.updateFrom():this.property||"attributes"!=t.type||"value"!==t.attributeName?"attributes"===t.type&&t.attributeName==this.property&&this.updateFrom():this.updateFrom())}get doUpdateFrom(){return["both","to"].indexOf(this.direction)>-1}updateFrom(){if(!this.doUpdateFrom)return;let t=this.valueFromElement;t="string"==typeof t&&t.trim()||t;let e=this.value;e="string"==typeof e&&e.trim()||e,e=this.formatter(e),e&&t==e||(this.value=t)}get doUpdateTo(){return["both","from"].indexOf(this.direction)>-1}updateTo(){if(!this.doUpdateTo)return;const t=this.formatter(this.value);this.property?this.tag.element.setAttribute(this.property,t):this.tag.value=t}setFormatter(t){this.formatter=t}};i([c.benchmark("Attribute",["Bind","compile"])],u.prototype,"compile",null),i([c.benchmark("attributeSetup","Bind")],u.prototype,"setup",null),u=i([a.Registry.attribute("vsn-bind")],u),e.Bind=u},3444:function(t,e,n){var i=this&&this.__decorate||function(t,e,n,i){var r,s=arguments.length,o=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,n,o):r(e,n))||o);return s>3&&o&&Object.defineProperty(e,n,o),o},r=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.ClassConstructor=void 0;const s=n(5092),o=n(1371),a=n(44);let c=class extends s.Attribute{setup(){return r(this,void 0,void 0,(function*(){const t=this.tag.parentTag.scope;if(!t)return;this.attributeKey=this.getAttributeBinding(),this.className=this.getAttributeValue();const e=yield o.Registry.instance.classes.get(this.className);this.instantiateClass(e),this.attributeKey&&t&&t.set(this.attributeKey,this.tag.scope)}))}instantiateClass(t){this.tag.wrap(t)}};c.scoped=!0,i([a.benchmark("attributeSetup","ClassConstructor")],c.prototype,"setup",null),c=i([o.Registry.attribute("vsn-controller")],c),e.ClassConstructor=c},9281:function(t,e,n){var i=this&&this.__decorate||function(t,e,n,i){var r,s=arguments.length,o=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,n,o):r(e,n))||o);return s>3&&o&&Object.defineProperty(e,n,o),o},r=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.ClickRemoveClass=void 0;const s=n(5092),o=n(1371),a=n(44);let c=class extends s.Attribute{constructor(){super(...arguments),this.cssClass="",this.target=null}setup(){return r(this,void 0,void 0,(function*(){this.cssClass=this.getAttributeBinding("active"),this.target=this.getAttributeValue()}))}connect(){return r(this,void 0,void 0,(function*(){this.tag.addEventHandler("click",this.getAttributeModifiers(),this.onClick.bind(this))}))}onClick(t){let e=this.tag.element;this.target&&(e=document.getElementById(this.target)),e&&e.classList.remove(this.cssClass)}};i([a.benchmark("attributeSetup","ClickRemoveClass")],c.prototype,"setup",null),c=i([o.Registry.attribute("vsn-click-remove-class")],c),e.ClickRemoveClass=c},2573:function(t,e,n){var i=this&&this.__decorate||function(t,e,n,i){var r,s=arguments.length,o=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,n,o):r(e,n))||o);return s>3&&o&&Object.defineProperty(e,n,o),o},r=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.ClickToggleClass=void 0;const s=n(5092),o=n(1371),a=n(44);let c=class extends s.Attribute{constructor(){super(...arguments),this.cssClass="",this.target=null}setup(){return r(this,void 0,void 0,(function*(){this.cssClass=this.getAttributeBinding("active"),this.target=this.getAttributeValue()}))}connect(){return r(this,void 0,void 0,(function*(){this.tag.addEventHandler("click",this.getAttributeModifiers(),this.onClick.bind(this))}))}onClick(t){let e=this.tag.element;this.target&&(e=document.getElementById(this.target)),e&&e.classList.toggle(this.cssClass)}};i([a.benchmark("attributeSetup","ClickToggleClass")],c.prototype,"setup",null),c=i([o.Registry.attribute("vsn-click-toggle-class")],c),e.ClickToggleClass=c},3650:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ControllerAttribute=void 0;const i=n(3444);class r extends i.ClassConstructor{}e.ControllerAttribute=r},4893:function(t,e,n){var i=this&&this.__decorate||function(t,e,n,i){var r,s=arguments.length,o=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,n,o):r(e,n))||o);return s>3&&o&&Object.defineProperty(e,n,o),o},r=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.DisableIf=void 0;const s=n(523),o=n(1371);let a=class extends s.If{onChange(){return r(this,void 0,void 0,(function*(){(yield this.tree.evaluate(this.tag.scope,this.tag.dom))?this.tag.element.setAttribute("disabled","disabled"):this.tag.element.removeAttribute("disabled")}))}};a=i([o.Registry.attribute("vsn-disable-if")],a),e.DisableIf=a},6813:function(t,e,n){var i=this&&this.__decorate||function(t,e,n,i){var r,s=arguments.length,o=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,n,o):r(e,n))||o);return s>3&&o&&Object.defineProperty(e,n,o),o},r=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.Exec=void 0;const s=n(5092),o=n(7754),a=n(1371),c=n(44);let u=class extends s.Attribute{compile(){return r(this,void 0,void 0,(function*(){this.tree=new o.Tree(this.getAttributeValue()),yield this.tree.prepare(this.tag.scope,this.tag.dom)}))}extract(){return r(this,void 0,void 0,(function*(){yield this.tree.evaluate(this.tag.scope,this.tag.dom)}))}};i([c.benchmark("DOM",["attribute","exec","compile"])],u.prototype,"compile",null),u=i([a.Registry.attribute("vsn-exec")],u),e.Exec=u},8289:function(t,e,n){var i=this&&this.__decorate||function(t,e,n,i){var r,s=arguments.length,o=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,n,o):r(e,n))||o);return s>3&&o&&Object.defineProperty(e,n,o),o},r=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.Format=void 0;const s=n(5092),o=n(1371);let a=class extends s.Attribute{extract(){return r(this,void 0,void 0,(function*(){const t=this.getAttributeValue(null),e=this.getAttributeBinding(null),n=yield o.Registry.instance.formats.get(t),i=e?`vsn-bind:${e}`:"vsn-bind";(yield this.tag.getAttribute(i)).setFormatter(n)}))}};a=i([o.Registry.attribute("vsn-format")],a),e.Format=a},523:function(t,e,n){var i=this&&this.__decorate||function(t,e,n,i){var r,s=arguments.length,o=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,n,o):r(e,n))||o);return s>3&&o&&Object.defineProperty(e,n,o),o},r=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.If=void 0;const s=n(5092),o=n(7754),a=n(1371);let c=class extends s.Attribute{compile(){return r(this,void 0,void 0,(function*(){const t=this.getAttributeValue();this.tree=new o.Tree(t),yield this.tree.prepare(this.tag.scope,this.tag.dom)}))}extract(){return r(this,void 0,void 0,(function*(){yield this.evaluate()}))}connect(){return r(this,void 0,void 0,(function*(){yield this.tree.bindToScopeChanges(this.tag.scope,this.onChange.bind(this))}))}evaluate(){return r(this,void 0,void 0,(function*(){yield this.onChange()}))}onChange(){return r(this,void 0,void 0,(function*(){(yield this.tree.evaluate(this.tag.scope,this.tag.dom))?this.tag.show():this.tag.hide()}))}};c=i([a.Registry.attribute("vsn-if")],c),e.If=c},9215:function(t,e,n){var i=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.KeyAbstract=void 0;const r=n(8447);class s extends r.On{constructor(){super(...arguments),this.specificKey=null}compile(){const t=Object.create(null,{compile:{get:()=>super.compile}});return i(this,void 0,void 0,(function*(){yield t.compile.call(this),this.specificKey=this.getAttributeBinding()}))}connect(){return i(this,void 0,void 0,(function*(){this.tag.addEventHandler("keydown",this.getAttributeModifiers(),this.handleEvent.bind(this))}))}handleEvent(t){const e=Object.create(null,{handleEvent:{get:()=>super.handleEvent}});return i(this,void 0,void 0,(function*(){let n=!1;-1===[void 0,null,""].indexOf(this.specificKey)&&t.key.toLowerCase()!==this.specificKey&&t.code.toLowerCase()!==this.specificKey||(n=!0),n&&(yield e.handleEvent.call(this,t))}))}}e.KeyAbstract=s},9459:function(t,e,n){var i=this&&this.__decorate||function(t,e,n,i){var r,s=arguments.length,o=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,n,o):r(e,n))||o);return s>3&&o&&Object.defineProperty(e,n,o),o},r=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.KeyDown=void 0;const s=n(9215),o=n(1371);let a=class extends s.KeyAbstract{connect(){return r(this,void 0,void 0,(function*(){this.tag.addEventHandler("keydown",this.getAttributeModifiers(),this.handleEvent.bind(this))}))}};a=i([o.Registry.attribute("vsn-key-down")],a),e.KeyDown=a},7459:function(t,e,n){var i=this&&this.__decorate||function(t,e,n,i){var r,s=arguments.length,o=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,n,o):r(e,n))||o);return s>3&&o&&Object.defineProperty(e,n,o),o},r=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.KeyUp=void 0;const s=n(9215),o=n(1371);let a=class extends s.KeyAbstract{connect(){return r(this,void 0,void 0,(function*(){this.tag.addEventHandler("keyup",this.getAttributeModifiers(),this.handleEvent.bind(this))}))}};a=i([o.Registry.attribute("vsn-key-up")],a),e.KeyUp=a},2496:function(t,e,n){var i=this&&this.__decorate||function(t,e,n,i){var r,s=arguments.length,o=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,n,o):r(e,n))||o);return s>3&&o&&Object.defineProperty(e,n,o),o},r=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.List=void 0;const s=n(5092),o=n(4843),a=n(7754),c=n(2712),u=n(1371),l=n(44);let h=class extends s.Attribute{compile(){return r(this,void 0,void 0,(function*(){const t=this.getAttributeBinding();this.tree=new a.Tree(t),yield this.tree.prepare(this.tag.scope,this.tag.dom)}))}setup(){return r(this,void 0,void 0,(function*(){if(this.tag.element.children.length>0){const t=this.tag.element.children[0];t.hasAttribute("vsn-template")?(t.removeAttribute("vsn-template"),this.tag.element.removeChild(t),this.template=t):this.template=t.cloneNode(!0)}}))}extract(){return r(this,void 0,void 0,(function*(){const t=yield this.tree.evaluate(this.tag.scope,this.tag.dom);yield this.addExistingItems(t)}))}addExistingItems(t){return r(this,void 0,void 0,(function*(){if(this.items=t||new o.WrappedArray,this.tags=[],t)for(const e of t)yield this.add(e);for(const t of Array.from(this.tag.element.querySelectorAll("*"))){if(!c.ElementHelper.hasVisionAttribute(t,"vsn-list-item"))continue;const e=yield this.tag.dom.getTagForElement(t);e&&(this.tags.push(e),this.items.push(e.scope.wrapped||e.scope))}this.items instanceof o.WrappedArray||(this.items=new o.WrappedArray(this.items)),this.items.bind("add",(t=>{this.add(t)})),this.items.bind("remove",(t=>{this.remove(t)})),this.tag.scope.set("add",this.add.bind(this)),this.tag.scope.set("remove",this.remove.bind(this))}))}get listItemName(){return this.tag.getRawAttributeValue("vsn-list-item-name","item")}get listItemModel(){return this.tag.getRawAttributeValue("vsn-list-item-model","Object")}remove(t){for(let e=0;e<this.tags.length;e++){const n=this.tags[e],i=n.scope.get(this.listItemName);if([i,i.wrapped].indexOf(t)>-1)return n.removeFromDOM(),void this.tags.splice(e,1)}}add(t){return r(this,void 0,void 0,(function*(){const e=this.template.cloneNode(!0);this.tag.element.appendChild(e),yield this.tag.dom.buildFrom(this.tag.element);const n=yield this.tag.dom.getTagForElement(e);this.tags.push(n),n.scope.clear(),t&&(n.unwrap(),n.wrap(t)),this.tag.trigger("add",t)}))}};h.scoped=!0,i([l.benchmark("attributeSetup","List")],h.prototype,"setup",null),h=i([u.Registry.attribute("vsn-list")],h),e.List=h},987:function(t,e,n){var i,r=this&&this.__decorate||function(t,e,n,i){var r,s=arguments.length,o=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,n,o):r(e,n))||o);return s>3&&o&&Object.defineProperty(e,n,o),o},s=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.ListItem=void 0;const o=n(5092),a=n(1371),c=n(44);let u=i=class extends o.Attribute{get list(){return this._list}setup(){return s(this,void 0,void 0,(function*(){if(this._list=this.tag.findAncestorByAttribute("vsn-list"),!this._list)throw Error(i.ERROR_NO_PARENT);this.tag.scope.set(this.listItemName,this.tag.scope);const t=(yield this.getList()).listItemModel,e=yield a.Registry.instance.classes.get(t);this.instantiateModel(e)}))}get listItemName(){return this.getAttributeBinding("item")}getList(){return s(this,void 0,void 0,(function*(){return yield this._list.getAttribute("vsn-list")}))}configure(){return s(this,void 0,void 0,(function*(){}))}instantiateModel(t){this.tag.wrap(t,!1,!0)}};u.scoped=!0,u.ERROR_NO_PARENT="Cannot find list parent.",r([c.benchmark("attributeSetup","ListItem")],u.prototype,"setup",null),u=i=r([a.Registry.attribute("vsn-list-item")],u),e.ListItem=u},274:function(t,e,n){var i=this&&this.__decorate||function(t,e,n,i){var r,s=arguments.length,o=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,n,o):r(e,n))||o);return s>3&&o&&Object.defineProperty(e,n,o),o};Object.defineProperty(e,"__esModule",{value:!0}),e.ListItemModel=void 0;const r=n(1371),s=n(5092);let o=class extends s.Attribute{};o=i([r.Registry.attribute("vsn-list-item-model")],o),e.ListItemModel=o},3329:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ModelAttribute=void 0;const i=n(3444);class r extends i.ClassConstructor{}e.ModelAttribute=r},1576:function(t,e,n){var i=this&&this.__decorate||function(t,e,n,i){var r,s=arguments.length,o=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,n,o):r(e,n))||o);return s>3&&o&&Object.defineProperty(e,n,o),o},r=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.Name=void 0;const s=n(5092),o=n(1371),a=n(44);let c=class extends s.Attribute{setup(){return r(this,void 0,void 0,(function*(){const t=this.tag.scope.parentScope;t&&t.set(this.tag.parsedAttributes["vsn-name"][1],this.tag.scope)}))}};c.scoped=!0,i([a.benchmark("attributeSetup","Name")],c.prototype,"setup",null),c=i([o.Registry.attribute("vsn-name")],c),e.Name=c},8447:function(t,e,n){var i=this&&this.__decorate||function(t,e,n,i){var r,s=arguments.length,o=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,n,o):r(e,n))||o);return s>3&&o&&Object.defineProperty(e,n,o),o},r=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.On=void 0;const s=n(5092),o=n(7754),a=n(1371);let c=class extends s.Attribute{compile(){return r(this,void 0,void 0,(function*(){const t=this.getAttributeValue();this.handler=new o.Tree(t),yield this.handler.prepare(this.tag.scope,this.tag.dom)}))}handleEvent(t){return r(this,void 0,void 0,(function*(){yield this.handler.evaluate(this.tag.scope,this.tag.dom)}))}connect(){return r(this,void 0,void 0,(function*(){this.tag.addEventHandler(this.getAttributeBinding(),this.getAttributeModifiers(),this.handleEvent.bind(this))}))}};c.WindowEvents=["abort","afterprint","beforeprint","error","hashchange","load","popstate","resize","unload"],c=i([a.Registry.attribute("vsn-on")],c),e.On=c},6338:function(t,e,n){var i=this&&this.__decorate||function(t,e,n,i){var r,s=arguments.length,o=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,n,o):r(e,n))||o);return s>3&&o&&Object.defineProperty(e,n,o),o};Object.defineProperty(e,"__esModule",{value:!0}),e.Referenced=void 0;const r=n(1371),s=n(5092);let o=class extends s.Attribute{};o=i([r.Registry.attribute("vsn-ref")],o),e.Referenced=o},6957:function(t,e,n){var i=this&&this.__decorate||function(t,e,n,i){var r,s=arguments.length,o=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,n,o):r(e,n))||o);return s>3&&o&&Object.defineProperty(e,n,o),o},r=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.RootAttribute=void 0;const s=n(5092),o=n(4264),a=n(1371),c=n(44);let u=class extends s.Attribute{setup(){return r(this,void 0,void 0,(function*(){this.tag.scope.set("$mobile",o.VisionHelper.isMobile())}))}};u.scoped=!0,i([c.benchmark("attributeSetup","RootAttribute")],u.prototype,"setup",null),u=i([a.Registry.attribute("vsn-root")],u),e.RootAttribute=u},5930:function(t,e,n){var i=this&&this.__decorate||function(t,e,n,i){var r,s=arguments.length,o=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,n,o):r(e,n))||o);return s>3&&o&&Object.defineProperty(e,n,o),o};Object.defineProperty(e,"__esModule",{value:!0}),e.ScopeAttribute=void 0;const r=n(5092),s=n(1371);let o=class extends r.Attribute{};o.scoped=!0,o=i([s.Registry.attribute("vsn-scope")],o),e.ScopeAttribute=o},1085:function(t,e,n){var i=this&&this.__decorate||function(t,e,n,i){var r,s=arguments.length,o=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,n,o):r(e,n))||o);return s>3&&o&&Object.defineProperty(e,n,o),o},r=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.ScopeChange=void 0;const s=n(5092),o=n(7754),a=n(1371);let c=class extends s.Attribute{compile(){return r(this,void 0,void 0,(function*(){const t=this.getAttributeValue();this.handler=new o.Tree(t),yield this.handler.prepare(this.tag.scope,this.tag.dom)}))}connect(){return r(this,void 0,void 0,(function*(){const t=this.getAttributeBinding(),e=this.tag.scope.getReference(t,!1);e.scope.bind(`change:${e.key}`,this.handleEvent.bind(this))}))}handleEvent(t){return r(this,void 0,void 0,(function*(){yield this.handler.evaluate(this.tag.scope,this.tag.dom)}))}};c=i([a.Registry.attribute("vsn-scope-change")],c),e.ScopeChange=c},3070:function(t,e,n){var i=this&&this.__decorate||function(t,e,n,i){var r,s=arguments.length,o=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,n,o):r(e,n))||o);return s>3&&o&&Object.defineProperty(e,n,o),o},r=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.SetAttribute=void 0;const s=n(5092),o=n(1371),a=n(44);let c=class extends s.Attribute{set value(t){this.boundScope&&this.boundScope.set(this.key,t)}get value(){return this.boundScope?this.boundScope.get(this.key,!1):null}setup(){return r(this,void 0,void 0,(function*(){let t;this.property=this.getAttributeBinding();try{t=this.tag.scope.getReference(this.property)}catch(t){return}this.key=t.key,this.boundScope=t.scope}))}extract(){return r(this,void 0,void 0,(function*(){let t=this.getAttributeValue(null);const e=t&&t.indexOf("|")||-1;e>-1&&(this.boundScope.setType(this.key,t.substr(e+1)),t=t.substr(0,e)),this.boundScope.set(this.key,t)}))}};i([a.benchmark("attributeSetup","SetAttribute")],c.prototype,"setup",null),c=i([o.Registry.attribute("vsn-set")],c),e.SetAttribute=c},6032:function(t,e,n){var i=this&&this.__decorate||function(t,e,n,i){var r,s=arguments.length,o=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,n,o):r(e,n))||o);return s>3&&o&&Object.defineProperty(e,n,o),o},r=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.StandardAttribute=void 0;const s=n(5092),o=n(44);class a extends s.Attribute{setup(){return r(this,void 0,void 0,(function*(){-1!==a.magicAttributes.indexOf(this.key)||this.tag.element.hasAttribute(this.attributeName)||this.tag.element.setAttribute(this.attributeName,"")}))}extract(){return r(this,void 0,void 0,(function*(){this.updateFrom()}))}connect(){return r(this,void 0,void 0,(function*(){this.tag.scope.bind(`change:${this.key}`,this.updateTo.bind(this))}))}mutate(t){super.mutate(t),this.updateFrom()}get needsToBeSynced(){let t=this.tag.scope.get(this.key)||"",e=this.value;return t&&t.trim&&(t=t.trim()),e&&e.trim&&(e=e.trim()),t instanceof Array?!(e instanceof Array&&t.length===e.length)||t.map((t=>e.indexOf(t)>-1)).indexOf(!1)>-1:t!==e}updateTo(){this.needsToBeSynced&&(this.value=this.tag.scope.get(`@${this.attributeName}`))}updateFrom(){this.needsToBeSynced&&this.tag.scope.set(this.key,this.value)}get key(){return`@${this.attributeName}`}set value(t){if("@text"===this.key)this.tag.element.innerText=t;else if("@html"===this.key)this.tag.element.innerHTML=t;else if("@value"===this.key)this.tag.value=t;else if("@class"===this.key&&t){this.tag.element.classList.remove(...Array.from(this.tag.element.classList));const e=t instanceof Array?t:[t];e.length&&this.tag.element.classList.add(...e)}else this.tag.element.setAttribute(this.attributeName,t)}get value(){return"@text"===this.key?this.tag.element.innerText:"@html"===this.key?this.tag.element.innerHTML:"@value"===this.key?this.tag.value:"@class"===this.key?Array.from(this.tag.element.classList):this.tag.element.getAttribute(this.attributeName)}}a.magicAttributes=["@text","@html","@class","@value"],i([o.benchmark("attributeSetup","StandardAttribute")],a.prototype,"setup",null),e.StandardAttribute=a},1514:function(t,e,n){var i=this&&this.__decorate||function(t,e,n,i){var r,s=arguments.length,o=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,n,o):r(e,n))||o);return s>3&&o&&Object.defineProperty(e,n,o),o};Object.defineProperty(e,"__esModule",{value:!0}),e.Template=void 0;const r=n(1371),s=n(5092);let o=class extends s.Attribute{};o=i([r.Registry.attribute("vsn-template")],o),e.Template=o},8696:function(t,e,n){var i=this&&this.__decorate||function(t,e,n,i){var r,s=arguments.length,o=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,n,o):r(e,n))||o);return s>3&&o&&Object.defineProperty(e,n,o),o},r=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.TypeAttribute=void 0;const s=n(5092),o=n(1371);let a=class extends s.Attribute{extract(){return r(this,void 0,void 0,(function*(){const t=this.getAttributeBinding();let e,n=this.getAttributeValue();try{e=this.tag.scope.getReference(t)}catch(t){return void console.error("error",t)}e.scope.setType(e.key,n)}))}};a=i([o.Registry.attribute("vsn-type")],a),e.TypeAttribute=a},2132:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),n(8041),n(8171),n(9281),n(2573),n(3650),n(4893),n(6813),n(8289),n(523),n(9459),n(7459),n(2496),n(987),n(274),n(3329),n(1576),n(8447),n(6338),n(6957),n(5930),n(1085),n(3070),n(6032),n(1514),n(8696)},2712:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ElementHelper=void 0,e.ElementHelper=class{static hasVisionAttribute(t,e="vsn-"){if(!t.attributes||t.attributes.length<=0)return!1;for(let n=0;n<t.attributes.length;n++)if(t.attributes[n].name.startsWith(e))return!0;return!1}static normalizeElementID(t){return t?t.replace(/-([a-zA-Z0-9])/g,(function(t){return t[1].toUpperCase()})):null}}},4264:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.VisionHelper=void 0;class n{static isConstructor(t){return t&&t.hasOwnProperty("prototype")&&!!t.prototype&&!!t.prototype.constructor&&!!t.prototype.constructor.name}static get document(){return"object"==typeof document?document:null}static get window(){return"object"==typeof window?window:null}static isMobile(){let t=!1;var e;return navigator&&n.window&&(e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0)),t}static get inDevelopment(){return!1}static get doBenchmark(){return!0}static get inLegacy(){return"es5"===process.env.BUILD_TARGET}}e.VisionHelper=n}},e={};!function n(i){var r=e[i];if(void 0!==r)return r.exports;var s=e[i]={exports:{}};return t[i].call(s.exports,s,s.exports,n),s.exports}(8943)})();